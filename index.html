<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>WebXR Start!</title>
		<style>
			body { margin: 0; }

			.vr-button,
			.xr-button {
				position: fixed;
				left: calc(50% - 50px) !important;
				bottom: 20px;
				width: 100px;
				padding: 12px 6px;
				color: rgba(255, 255, 255, 1.0);
				cursor: pointer;
				border: 1px solid rgb(255, 255, 255);
				border-radius: 4px;
				background: rgba(10, 10, 10, 0.5);
				font: 14px sans-serif;
				font-weight: bold;
				text-align: center;
				opacity: 0.5;
				outline: none;
				z-index: 999;
			}

			#loading {
				position: fixed;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				display: flex;
				justify-content: center;
				align-items: center;
			}
			#loading .progress {
				margin: 1.5em;
				border: 1px solid white;
				width: 50vw;
			}
			#loading .progressbar {
				margin: 2px;
				background: white;
				height: 1em;
				transform-origin: top left;
				transform: scaleX(0);
			}
		</style>
		<script type="importmap">
			{
				"imports": {
					"three": "../build/three.module.js",
					"three/addons/": "./jsm/"
				}
			}
		</script>
		<!-- Basic intro to shaders from:
		  -- https://webglfundamentals.org/webgl/lessons/webgl-how-it-works.html
		  -->
		<!-- vertex shader -->
		<script  id="vertexShader" type="x-shader/x-vertex">

			varying vec4 v_color;

			// From THREE.ShaderChunk.meshphysical_vert
			#define STANDARD
			varying vec3 vViewPosition;
			#ifdef USE_TRANSMISSION
				varying vec3 vWorldPosition;
			#endif
			#include <common>
			#include <batching_pars_vertex>
			#include <uv_pars_vertex>
			#include <displacementmap_pars_vertex>
			#include <color_pars_vertex>
			#include <fog_pars_vertex>
			#include <normal_pars_vertex>
			#include <morphtarget_pars_vertex>
			#include <skinning_pars_vertex>
			#include <shadowmap_pars_vertex>
			#include <logdepthbuf_pars_vertex>
			#include <clipping_planes_pars_vertex>

			void main() {
				#include <uv_vertex>
				#include <color_vertex>
				#include <morphinstance_vertex>
				#include <morphcolor_vertex>
				#include <batching_vertex>
				#include <beginnormal_vertex>
				#include <morphnormal_vertex>
				#include <skinbase_vertex>
				#include <skinnormal_vertex>
				#include <defaultnormal_vertex>
				#include <normal_vertex>
				#include <begin_vertex>
				#include <morphtarget_vertex>
				#include <skinning_vertex>
				#include <displacementmap_vertex>
				#include <project_vertex>
				#include <logdepthbuf_vertex>
				#include <clipping_planes_vertex>
				vViewPosition = - mvPosition.xyz;
				#include <worldpos_vertex>
				#include <shadowmap_vertex>
				#include <fog_vertex>
				#ifdef USE_TRANSMISSION
					vWorldPosition = worldPosition.xyz;
				#endif

			  // vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
			  gl_Position = projectionMatrix * mvPosition;

			  // Convert from clipspace to colorspace.
			  // Clipspace goes -1.0 to +1.0
			  // Colorspace goes from 0.0 to 1.0
			  v_color = gl_Position * 0.5 + 0.5;
			}

		</script>
		<!-- fragment shader -->
		<script  id="fragmentShader" type="x-shader/x-fragment">

			varying vec4 v_color;

			#define STANDARD
			#ifdef PHYSICAL
				#define IOR
				#define USE_SPECULAR
			#endif
			uniform vec3 diffuse;
			uniform vec3 emissive;
			uniform float roughness;
			uniform float metalness;
			uniform float opacity;
			#ifdef IOR
				uniform float ior;
			#endif
			#ifdef USE_SPECULAR
				uniform float specularIntensity;
				uniform vec3 specularColor;
				#ifdef USE_SPECULAR_COLORMAP
					uniform sampler2D specularColorMap;
				#endif
				#ifdef USE_SPECULAR_INTENSITYMAP
					uniform sampler2D specularIntensityMap;
				#endif
			#endif
			#ifdef USE_CLEARCOAT
				uniform float clearcoat;
				uniform float clearcoatRoughness;
			#endif
			#ifdef USE_DISPERSION
				uniform float dispersion;
			#endif
			#ifdef USE_IRIDESCENCE
				uniform float iridescence;
				uniform float iridescenceIOR;
				uniform float iridescenceThicknessMinimum;
				uniform float iridescenceThicknessMaximum;
			#endif
			#ifdef USE_SHEEN
				uniform vec3 sheenColor;
				uniform float sheenRoughness;
				#ifdef USE_SHEEN_COLORMAP
					uniform sampler2D sheenColorMap;
				#endif
				#ifdef USE_SHEEN_ROUGHNESSMAP
					uniform sampler2D sheenRoughnessMap;
				#endif
			#endif
			#ifdef USE_ANISOTROPY
				uniform vec2 anisotropyVector;
				#ifdef USE_ANISOTROPYMAP
					uniform sampler2D anisotropyMap;
				#endif
			#endif
			varying vec3 vViewPosition;
			#include <common>
			#include <packing>
			#include <dithering_pars_fragment>
			#include <color_pars_fragment>
			#include <uv_pars_fragment>
			#include <map_pars_fragment>
			#include <alphamap_pars_fragment>
			#include <alphatest_pars_fragment>
			#include <alphahash_pars_fragment>
			#include <aomap_pars_fragment>
			#include <lightmap_pars_fragment>
			#include <emissivemap_pars_fragment>
			#include <iridescence_fragment>
			#include <cube_uv_reflection_fragment>
			#include <envmap_common_pars_fragment>
			#include <envmap_physical_pars_fragment>
			#include <fog_pars_fragment>
			#include <lights_pars_begin>
			#include <normal_pars_fragment>
			#include <lights_physical_pars_fragment>
			#include <transmission_pars_fragment>
			#include <shadowmap_pars_fragment>
			#include <bumpmap_pars_fragment>
			#include <normalmap_pars_fragment>
			#include <clearcoat_pars_fragment>
			#include <iridescence_pars_fragment>
			#include <roughnessmap_pars_fragment>
			#include <metalnessmap_pars_fragment>
			#include <logdepthbuf_pars_fragment>
			#include <clipping_planes_pars_fragment>

			void main() {
				vec4 diffuseColor = vec4( diffuse, opacity );
				#include <clipping_planes_fragment>
				ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
				vec3 totalEmissiveRadiance = emissive;
				#include <logdepthbuf_fragment>
				#include <map_fragment>
				#include <color_fragment>
				#include <alphamap_fragment>
				#include <alphatest_fragment>
				#include <alphahash_fragment>
				#include <roughnessmap_fragment>
				#include <metalnessmap_fragment>
				#include <normal_fragment_begin>
				#include <normal_fragment_maps>
				#include <clearcoat_normal_fragment_begin>
				#include <clearcoat_normal_fragment_maps>
				#include <emissivemap_fragment>
				#include <lights_physical_fragment>
				#include <lights_fragment_begin>
				#include <lights_fragment_maps>
				#include <lights_fragment_end>
			  // gl_FragColor = vec4(1, 0, 0, 1);
			  // gl_FragColor = vec4(vNormal * 0.5 + 0.5, 1);
			  gl_FragColor = v_color;
			}
		</script>
	</head>
	<body>
		<script type="module" src="src/main.js"></script>
	</body>
</html>
